{%- doc -%}
  Renders the sorting component as an accordion with checkboxes.

  @param {object} results - The results of the search
  @param {string} sort_by - The current sort by
  @param {string} filter_style - The filter style
  @param {string} [suffix] - { 'desktop' | 'mobile' | 'overflow' } Used on `form` attributes to connect inputs to a form[id]
  @param {string} [sort_position] - { 'desktop' | 'mobile' } Used in a data-testID selector for automated testing
  @param {boolean} should_use_select_on_mobile - Whether to use a select element for the sorting component on mobile
  @param {string} section_id - The section ID
{%- enddoc -%}

<sorting-filter-component
  class="sorting-filter{% if filter_style == 'horizontal' %} sorting-filter__horizontal{% endif %}"
  on:change="/updateFilterAndSorting"
  on:keydown="/handleKeyDown"
  {% if sort_position != blank %}
    data-testid="sorting-filter-component-{{ sort_position }}"
  {% endif %}
  data-should-use-select-on-mobile="{{ should_use_select_on_mobile }}"
>
  {% liquid
    assign default_sort_by = results.default_sort_by
    for option in results.sort_options
      if option.value == sort_by
        assign status = option.name
      endif
    endfor
  %}

  <div class="sorting-filter__accordion">
    <details class="accordion">
      <summary class="accordion__header">
        <span class="accordion__title">
          {{- 'actions.sort' | t -}}
        </span>
        <span class="accordion__icon">
          <svg
            aria-hidden="true"
            focusable="false"
            class="icon icon-plus"
            width="12"
            height="12"
            viewBox="0 0 12 12"
          >
            <path d="M6 0v6H0v1h6v6h1V7h6V6H7V0H6z" />
          </svg>
        </span>
      </summary>
      <div class="accordion__content">
        {% for option in results.sort_options %}
          <label class="sorting-filter__checkbox-label" for="sort-option-{{ option.value }}-{{ section_id }}">
            <input
              type="checkbox"
              name="sort_by"
              id="sort-option-{{ option.value }}-{{ section_id }}"
              {% if suffix != blank %}
                form="FacetFiltersForm--{{ section_id }}-{{ suffix }}"
              {% endif %}
              value="{{ option.value }}"
              class="sorting-filter__checkbox-input"
              {% if option.value == sort_by %}
                checked
              {% endif %}
            >
            <span class="sorting-filter__checkbox-text">{{ option.name }}</span>
          </label>
        {% endfor %}
      </div>
    </details>
  </div>
</sorting-filter-component>

{% stylesheet %}
  .sorting-filter__accordion {
    padding: var(--padding-sm);
  }

  .accordion {
    border: none;
    margin: 0;
    padding: 0;
  }

  .accordion__header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    cursor: pointer;
    padding: var(--padding-sm) 0;
    border-bottom: 1px solid var(--color-border);
  }

  .accordion__title {
    font-size: 12px;
    font-weight: 500;
  }

  .accordion__icon {
    display: flex;
    align-items: center;
    justify-content: center;
    width: var(--icon-size-sm);
    height: var(--icon-size-sm);
  }

  .accordion__content {
    display: none;
    padding: var(--padding-sm) 0;
  }

  details[open] .accordion__content {
    display: block;
  }

  .sorting-filter__checkbox-label {
    display: flex;
    align-items: center;
    gap: var(--gap-sm);
    padding: var(--padding-xs) 0;
  }

  .sorting-filter__checkbox-input {
    appearance: none;
    width: var(--icon-size-sm);
    height: var(--icon-size-sm);
    border: 1px solid var(--color-border);
    border-radius: var(--border-radius);
    cursor: pointer;
    position: relative;
  }

  .sorting-filter__checkbox-input:checked {
    background-color: var(--color-primary);
    border-color: var(--color-primary);
  }

  .sorting-filter__checkbox-input:checked::after {
    content: '';
    position: absolute;
    top: 50%;
    left: 50%;
    width: 6px;
    height: 6px;
    background-color: var(--color-background);
    border-radius: 50%;
    transform: translate(-50%, -50%);
  }

  .sorting-filter__checkbox-text {
    font-size: var(--font-paragraph--size);
    color: var(--color-foreground);
  }
{% endstylesheet %}
