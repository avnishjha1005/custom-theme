{% assign ai_gen_id = block.id | replace: '_', '' | downcase %}

{% style %}
  /* --- Base Layout --- */
  .ai-quote-section-{{ ai_gen_id }} {
    width: 100%;
    overflow: hidden;
 background-color: {{ block.settings.text_background_color }};
 width:100vw;
  }

  .ai-quote-section__container-{{ ai_gen_id }} {
    display: flex;
    flex-wrap: wrap;
    width: 100%;
    margin: 0 auto;
   
  }

  /* --- Image Logic --- */
  .ai-quote-section__image-wrapper-{{ ai_gen_id }} {
    position: relative;
    overflow: hidden;
  }

  .ai-quote-section__image-{{ ai_gen_id }} {
    width: 100%;
    height: 100%;
    display: block;
    object-fit: cover;
    object-position: center;
  }

  .ai-quote-section__image-placeholder-{{ ai_gen_id }} {
    width: 100%;
    height: 100%;
    background-color: #e0e0e0;
    display: flex;
    align-items: center;
    justify-content: center;
    color: #a0a0a0;
  }

  /* --- Text Logic --- */
  .ai-quote-section__content-wrapper-{{ ai_gen_id }} {
    display: flex;
    align-items: center;
    justify-content: center;
    padding: {{ block.settings.desktop_text_padding }}px;
  }

  .ai-quote-section__content-inner-{{ ai_gen_id }} {
    width: 100%;
    display: flex;
    flex-direction: column;
    align-items: {{ block.settings.text_alignment }};
    text-align: {{ block.settings.text_alignment }};
    gap: {{ block.settings.text_spacing }}px;
  }

  /* --- Typography --- */
  .ai-quote-section__quote-{{ ai_gen_id }} {
    font-size: {{ block.settings.quote_font_size }}px;
    line-height: {{ block.settings.quote_line_height }};
    color: {{ block.settings.quote_color }};
    font-style: {{ block.settings.quote_font_style }};
    font-weight: {{ block.settings.quote_font_weight }};
    font-family: {{ block.settings.quote_font_family }};
    margin: 0;
  }

  .ai-quote-section__separator-{{ ai_gen_id }} {
    width: {{ block.settings.separator_width }}px;
    height: {{ block.settings.separator_height }}px;
    background-color: {{ block.settings.separator_color }};
    margin: 5px 0;
  }

  .ai-quote-section__author-{{ ai_gen_id }} {
    font-size: {{ block.settings.author_font_size }}px;
    line-height: {{ block.settings.author_line_height }};
    color: {{ block.settings.author_color }};
    font-weight: {{ block.settings.author_font_weight }};
    text-transform: {{ block.settings.author_text_transform }};
    letter-spacing: 1px;
    margin: 0;
  }

  /* --- DESKTOP SPECIFIC (Split Screen) --- */
  @media screen and (min-width: 750px) {
    .ai-quote-section__container-{{ ai_gen_id }} {
      flex-direction: row;
      align-items: stretch;
      width: full;
    }

    .ai-quote-section__image-wrapper-{{ ai_gen_id }} {
      width: 40%;
      height: 480px;
      {% if block.settings.desktop_image_position == 'right' %}
        order: 2;
      {% else %}
        order: 1;
      {% endif %}
    }

    .ai-quote-section__content-wrapper-{{ ai_gen_id }} {
      width: 50%;
      background-color: {{ block.settings.text_background_color }};
      {% if block.settings.desktop_image_position == 'right' %}
        order: 1;
      {% else %}
        order: 2;
      {% endif %}
    }
  }

  /* --- MOBILE SPECIFIC (Stacked Layout) --- */
  @media screen and (max-width: 749px) {
    .ai-quote-section__container-{{ ai_gen_id }} {
      flex-direction: column;
      min-height: auto;
      position: relative; /* Anchor for the absolute image */
      width: 100%; /* Ensure container is as wide as screen */
      /* Add padding bottom to ensure content isn't hidden behind the absolute image if it sits on top, 
         or just enough space for the design breathing room */
      height: 500px;
    }

    .ai-quote-section__image-wrapper-{{ ai_gen_id }} {
      position: absolute;
      bottom: -150px;
      left: 50%;
      transform: translate(-50%, -50%);
      width: auto; /* Let image define width or use mobile_image_width */
      height: auto;
       /* Sit on top of content if they overlap */
      background: transparent;
      margin: 0;
    }

    .ai-quote-section__image-{{ ai_gen_id }} {
      width: {{ block.settings.mobile_image_width }}px;
      height: auto;
      max-width: 90vw;
      object-fit: contain;
      display: block;
    }

    .ai-quote-section__content-wrapper-{{ ai_gen_id }} {
      width: 100%;
      padding: {{ block.settings.mobile_text_padding }}px 0; /* Remove side padding, handle via inner width */
      position: relative;
      z-index: 1;
    }

    .ai-quote-section__content-inner-{{ ai_gen_id }} {
      width: 85vw; /* Fixed width as requested */
      margin: 0 auto; /* Center alignment */
      align-items: center;
      text-align: center;
    }

    .ai-quote-section__quote-{{ ai_gen_id }} {
      font-size: {{ block.settings.mobile_quote_font_size }}px;
      text-align: center;
      max-width:300px;
    }

    .ai-quote-section__author-{{ ai_gen_id }} {
      font-size: {{ block.settings.mobile_author_font_size }}px;
      text-align: center;
    }

    .ai-quote-section__separator-{{ ai_gen_id }} {
      margin-left: auto;
      margin-right: auto;
    }
  }
{% endstyle %}

<div class="ai-quote-section-{{ ai_gen_id }}" {{ block.shopify_attributes }}>
  <div class="ai-quote-section__container-{{ ai_gen_id }}">
    
    <div class="ai-quote-section__image-wrapper-{{ ai_gen_id }}">
      {% if block.settings.image %}
        <img
          src="{{ block.settings.image | image_url: width: 2000 }}"
          alt="{{ block.settings.image.alt | escape }}"
          loading="lazy"
          width="{{ block.settings.image.width }}"
          height="{{ block.settings.image.height }}"
          class="ai-quote-section__image-{{ ai_gen_id }}"
        >
      {% else %}
        <div class="ai-quote-section__image-placeholder-{{ ai_gen_id }}">
          {{ 'image' | placeholder_svg_tag }}
        </div>
      {% endif %}
    </div>

    <div class="ai-quote-section__content-wrapper-{{ ai_gen_id }}">
      <div class="ai-quote-section__content-inner-{{ ai_gen_id }}">
        
        {% if block.settings.quote != blank %}
          <blockquote class="ai-quote-section__quote-{{ ai_gen_id }}">
            &ldquo;{{ block.settings.quote }}&rdquo;
          </blockquote>
        {% endif %}

        {% if block.settings.show_separator %}
          <div class="ai-quote-section__separator-{{ ai_gen_id }}"></div>
        {% endif %}

        {% if block.settings.author != blank %}
          <p class="ai-quote-section__author-{{ ai_gen_id }}">
            {{ block.settings.author }}
          </p>
        {% endif %}
        
      </div>
    </div>

  </div>
</div>

{% schema %}
{
  "name": "Lux Split Quote",
  "settings": [
    {
      "type": "header",
      "content": "Colors"
    },
    {
      "type": "color",
      "id": "text_background_color",
      "label": "Background Color",
      "info": "This sets the color for the text side (Desktop) and the whole section (Mobile).",
      "default": "#4A3B32"
    },
    {
      "type": "header",
      "content": "Image"
    },
    {
      "type": "image_picker",
      "id": "image",
      "label": "Image"
    },
    {
      "type": "select",
      "id": "desktop_image_position",
      "label": "Desktop Image Position",
      "options": [
        { "value": "left", "label": "Left" },
        { "value": "right", "label": "Right" }
      ],
      "default": "left"
    },
    {
      "type": "range",
      "id": "desktop_min_height",
      "min": 400,
      "max": 900,
      "step": 50,
      "unit": "px",
      "label": "Desktop Height",
      "default": 600
    },
    {
      "type": "header",
      "content": "Text Content"
    },
    {
      "type": "textarea",
      "id": "quote",
      "label": "Quote",
      "default": "Lorem ipsum dolor sit amet, consectetur adipiscing elit. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur."
    },
    {
      "type": "text",
      "id": "author",
      "label": "Author",
      "default": "NOSTRUD EXERCITATION LABORIS"
    },
    {
      "type": "select",
      "id": "text_alignment",
      "label": "Desktop Alignment",
      "options": [
        { "value": "flex-start", "label": "Left" },
        { "value": "center", "label": "Center" },
        { "value": "flex-end", "label": "Right" }
      ],
      "default": "center"
    },
    {
      "type": "range",
      "id": "content_max_width",
      "min": 300,
      "max": 800,
      "step": 20,
      "unit": "px",
      "label": "Max Width",
      "default": 500
    },
    {
      "type": "range",
      "id": "text_spacing",
      "min": 10,
      "max": 60,
      "step": 5,
      "unit": "px",
      "label": "Spacing",
      "default": 30
    },
    {
      "type": "range",
      "id": "desktop_text_padding",
      "min": 20,
      "max": 100,
      "step": 5,
      "unit": "px",
      "label": "Desktop Padding",
      "default": 60
    },
    {
      "type": "header",
      "content": "Typography"
    },
    {
      "type": "range",
      "id": "quote_font_size",
      "min": 18,
      "max": 80,
      "step": 2,
      "unit": "px",
      "label": "Quote Size",
      "default": 36
    },
    {
      "type": "select",
      "id": "quote_font_family",
      "label": "Font Family",
      "options": [
        { "value": "inherit", "label": "Theme Default" },
        { "value": "Marcellus", "label": "Serif" },
        { "value": "sans-serif", "label": "Sans Serif" }
      ],
      "default": "Marcellus"
    },
    {
      "type": "select",
      "id": "quote_font_style",
      "label": "Style",
      "options": [
        { "value": "normal", "label": "Normal" },
        { "value": "italic", "label": "Italic" }
      ],
      "default": "normal"
    },
    {
      "type": "select",
      "id": "quote_line_height",
      "label": "Line Height",
      "options": [
        { "value": "1.1", "label": "Tight" },
        { "value": "1.3", "label": "Normal" },
        { "value": "1.6", "label": "Loose" }
      ],
      "default": "1.3"
    },
    {
      "type": "select",
      "id": "quote_font_weight",
      "label": "Weight",
      "options": [
        { "value": "300", "label": "Light" },
        { "value": "400", "label": "Normal" },
        { "value": "600", "label": "Bold" }
      ],
      "default": "400"
    },
    {
      "type": "color",
      "id": "quote_color",
      "label": "Quote Color",
      "default": "#FFFFFF"
    },
    {
      "type": "header",
      "content": "Separator"
    },
    {
      "type": "checkbox",
      "id": "show_separator",
      "label": "Show Separator",
      "default": true
    },
    {
      "type": "range",
      "id": "separator_width",
      "min": 20,
      "max": 100,
      "step": 5,
      "unit": "px",
      "label": "Width",
      "default": 40
    },
    {
      "type": "range",
      "id": "separator_height",
      "min": 1,
      "max": 5,
      "step": 1,
      "unit": "px",
      "label": "Height",
      "default": 1
    },
    {
      "type": "color",
      "id": "separator_color",
      "label": "Color",
      "default": "#FFFFFF"
    },
    {
      "type": "header",
      "content": "Author Styles"
    },
    {
      "type": "range",
      "id": "author_font_size",
      "min": 10,
      "max": 24,
      "step": 1,
      "unit": "px",
      "label": "Author Size",
      "default": 12
    },
    {
      "type": "select",
      "id": "author_text_transform",
      "label": "Transform",
      "options": [
        { "value": "none", "label": "None" },
        { "value": "uppercase", "label": "Uppercase" }
      ],
      "default": "uppercase"
    },
    {
      "type": "color",
      "id": "author_color",
      "label": "Author Color",
      "default": "#FFFFFF"
    },
    {
      "type": "header",
      "content": "Mobile Settings"
    },
    {
      "type": "range",
      "id": "mobile_image_width",
      "min": 100,
      "max": 300,
      "step": 10,
      "unit": "px",
      "label": "Mobile Image Width",
      "default": 180
    },
    {
      "type": "range",
      "id": "mobile_quote_font_size",
      "min": 16,
      "max": 40,
      "step": 1,
      "unit": "px",
      "label": "Mobile Quote Size",
      "default": 24
    },
    {
      "type": "range",
      "id": "mobile_author_font_size",
      "min": 10,
      "max": 18,
      "step": 1,
      "unit": "px",
      "label": "Mobile Author Size",
      "default": 10
    },
    {
      "type": "range",
      "id": "mobile_text_padding",
      "min": 0,
      "max": 80,
      "step": 5,
      "unit": "px",
      "label": "Mobile Text Padding",
      "default": 40
    }
  ],
  "presets": [
    {
      "name": "Lux Split Quote"
    }
  ]
}
{% endschema %}